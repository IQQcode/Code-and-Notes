<!--
        	作者：2726109782@qq.com
        	时间：2019-05-24
        	描述：网页计算器
        -->
        
<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>Calculator</title>
		<style>
			/*显示样式框*/
			input {
			   	height:60px;
			    width: 395px;
			    front-size: 20px;
			}
			
			/**设置表格中的tr*/
			tr{ 
				/*文本对齐方式*/
				text-align: center;
			 }
			 td {
			 	/*指定单元格的高度和宽度*/
			 	width: 100px ; /*宽度*/
			 	height: 100px;/*高度*/
			 	font-size: 25px;/*单元格内的字体大小*/
			 }
			 
			 /*鼠标经过每一个td的变化*/
			 td:hover{
			 	background-color:pink;
			 	/*进过每一个单元格·鼠标箭头变成小手-*/
			 	cursor: pointer;
			 }
		</style>
	</head>
	<body>
		
		<!--
        	一、页面布局：
        	            1.div + CSS 的层级布局
        	            2.table布局( 5行4列的表格 )
        	            
        	二、设置点击事件：
        	                        将数字键归为一类，包含小数点
        	                        将运算符归为一类(+ - * /)
        	                        显示框，清除键，退格键，=号分别设置id
        	                        
        	三、获取标签对象： 
        -->
        
        
        <!--input标签的禁用输入功能
        	                              属性： disabled = "disabled"
        -->
        
        <center><input type = "text" value="0" id ="show" disabled="disabled" /></center>
         <!--  cellspacing :单元格和边框之间的空隙
             ceellpadding :单元格和单元格之间的空隙-->
        <table border="1px" cellspacing="0" cellpadding="2" align="center" width="400px" height="500px">
        	<tr>
        		<td id="clear">CE</td>
    		    <td id="del">Del</td>
        		<td >%</td>
        		<td class="operator">+</td>
        	</tr>
        	<tr>
        		<td class="num">7</td>
        		<td class="num">8</td>
        		<td class="num">9</td>
        		<td class="operator">-</td>
        	</tr>
        	<tr>
        		<td class="num">4</td>
        		<td class="num">5</td>
        		<td class="num">6</td>
        		<td class="operator">*</td>
        	</tr>
        	<tr>
        		<td class="num">1</td>
        		<td class="num">2</td>
        		<td class="num">3</td>
        		<td class="operator">/</td>
        	</tr>
        	<tr>
        		<td class="num">0</td>
        		<td colspan="2" id = "result">=</td>
        		<td class="num">.</td>	
        	</tr>
 </table>
	 </body>
	 
<script>
	//获取显示框对象
    var showResult = document.getElementById("show") ;
    //获取清除键对象
    var clear =document.getElementById("clear") ;
    //获取退格键对象
    var del = document.getElementById("del") ;
    //=号键对象
    var result = document.getElementById("result") ;
    
	//定义三个变量
		var numValue1 = "";
		var numValue2 = "";
		var oper = "";

//获取所有的数字键对象并且设置点击
var nums = document.getElementsByClassName("num") ;
//遍历nums列表
for(var i = 0 ; i <nums.length ; i++){
	//获取到了每一个数字键对象,设置点击
	nums[i].onclick = function(){
		
		//bug3:小数点只能出现一次
		if(this.innerText=="."){
			
			//小数点不能出现在第一位并且只能出现一次
			if(numValue1.indexOf(".")==-1 && numValue1.length>=1){
				numValue1 += this.innerText ;
		
		 		showResult.value=numValue1 *1 ; //去掉首尾无效0
			}
		}else{
              //没有出现小数点
		numValue1 += this.innerText ;
		
		 showResult.value=numValue1 *1;//去掉首尾无效0
		}
		//测试 
//		alert("获取到了数字键") ;
		 //var text = this.innerText ; //this:nums[i]
		 //将结果展示到显示框
		// showResult.value = text ;
//		showResult.value =this.innerText ;

//改进
/*
		numValue1 += this.innerText ;
		
		 showResult.value=numValue1 ;*/
	}
}

//获取所有的运算符,并设置点击事件
var operators = document.getElementsByClassName("operator") ;
for(var i = 0; i <operators.length ; i++){
	//设置点击
	operators[i].onclick = function(){
		if(numValue2==""){
			//将第一个数据赋值给第二个数据,在将第一个数据清空掉,等待(下次数据的输入)
			numValue2 =numValue1 ;
			numValue1 = "" ;
			//保存操作符
			oper = this.innerText ;
		}else{
			//numvalue2有值: 用户可能点击=号,或者继续进行点击运算符
			if(numValue1!=""){
				resultFun() ;
			}
			
			//bug2:如果乘法运算:点击等号进行结果:numvalue1=""  ,进行计算之前判断numValue不是空字符串
			
			//保存操作符
			oper = this.innerText ;
		}
		
		//如何确定用户点击完操作符之后,在使用第一个数据接收,判断用户下次点击=号继续点击运算符
		
		//alert("获取到了操作符") ;

		//操作符 
		/*//将第一个数据赋值给第二个数据,在将第一个数据清空掉,等待(下次数据的输入)
		numValue2 =numValue1 ;
		numValue1 = "" ;
		//保存操作符
		oper = this.innerText ;*/
	}
}
		
//*** 获取所有的运算符,并设置点击事件
var operators = document.getElementsByClassName("operator") ;
for(var i = 0; i <operators.length ; i++){
	//设置点击
	operators[i].onclick = function(){
		if(numValue2==""){
			//将第一个数据赋值给第二个数据,在将第一个数据清空掉,等待(下次数据的输入)
			numValue2 =numValue1 ;
			numValue1 = "" ;
			//保存操作符
			oper = this.innerText ;
		}else{
			//numvalue2有值: 用户可能点击=号,或者继续进行点击运算符
			if(numValue1!=""){
				resultFun() ;
			}
			
			//bug2:如果乘法运算:点击等号进行结果:numvalue1=""  ,进行计算之前判断numValue不是空字符串
			
			//保存操作符
			oper = this.innerText ;
		}
		
		//如何确定用户点击完操作符之后,在使用第一个数据接收,判断用户下次点击=号继续点击运算符
		
		//alert("获取到了操作符") ;

		//操作符 
		/*//将第一个数据赋值给第二个数据,在将第一个数据清空掉,等待(下次数据的输入)
		numValue2 =numValue1 ;
		numValue1 = "" ;
		//保存操作符
		oper = this.innerText ;*/
	}
}


		
		//清除键的逻辑处理
		clear.onclick = function() {
			//将一个数据numValue1，numValue2保存的操作符清空
			numValue1 = "";
			numValue2 = "";
			oper = "";
			//显示框的内容变为0
			showResult.value = "0";
		}

        //退格键的逻辑处理
        del.onclick =function() {
	
	        //判断numValue1如果长度不等于1
	        if(numValue1.length != 1) {
		   	//将numValue1的字符串截取：从0 开始到numValue1.length-1,在赋值给本身
		    numValue1 = numValue1.substring(0,numValue1.length-1) ;
		    //将numValue1显示
		   showResult.value=numValue1 ;
	}
	        
	        //如果是1,将numvalue1/numvale2清空掉(自己扩展)
}


/**
 * 计算的逻辑: 
 * 
 *                将numValue1的值赋值给了numValue2,将numValue1清空掉,等待下一次的输入
 * 
 *                numvalue1  ,numvalue2计算的结果--->(将计算的结果赋值给numvalue2,清空掉numValue1,保存操作符)
 * 
 *                在获取到运算符键的逻辑: 判断numvalue2是否为空
 * 
 */

    //给=好设置点击事件
    result.onclick = function() {
    	//四则运算符： 定义一个function
    	resultFun();
    }
    
    //运算
    function resultFun() {
    	//定义两个变量(类型转换)
    	var one = new Number(numValue1);
    	var two = new Number(numValue2);
    	//结果
    	var r = null;
    	
    	//使用switch进行判断
    	switch(oper) {  //保存的运算符
    case "+":
	    r = one + two ;
	    break ;
	case "-":
	    r = one - two ;
	    break ;
	case "*":
	    r = one * two ;
	    break ;
	case "/":
		//判断
		if(two==0) {
			alert("除数不能为0") ;
			//将numvalue1/numvalue2:清空
			numValue1 = "" ;
			numValue2 = "" ;
			oper = "" ;
			r = 0 ;
		}else {
			 r = one / two ;
		}
	    break ;
	   }
    	
    	//将计算结果赋值numValue2,清空numValue1,等待下一次输入计算
    	//如果点击= 号：将numValue2的结果展示到显示框
    	
    	//numValue2 = r;
    	//将结果保留有效位数
    	numValue2 = new Number(r).toFixed(6);
    	numValue1 = "";
    	//展示结果
    	showResult.value=numValue2 * 1;
    	
    	//Bug1 : 去掉收尾无效0 ---> num * 1(整数)
    }

</script>
</html>
